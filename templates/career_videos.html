<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Videos</title>
    
    <link rel="stylesheet" href="{{ url_for('static', filename='career_videos.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <center>
   <div class="search-container">
    <div class="search-wrapper">
        <input type="text" id="liveSearchBar" placeholder="Filter these results by keyword..." onkeyup="liveFilterVideos()">
        
        <i class="fas fa-microphone voice-icon" id="micIcon" onclick="startVoiceSearch()"></i>
        <i class="fas fa-search search-icon" onclick="liveFilterVideos()"></i>
    </div>
</div>
</center>
</div>
        
        <p class="subtitle">Showing results for: <strong>{{ search_query or 'All Active Job Skills' }}</strong></p>

        <div class="video-grid">
            {% for video_item in videos %}
                {% set highlight_class = 'is-relevant' if video_item.is_relevant else '' %}
                
                <div class="video-card {{ highlight_class }}" data-tags="{{ video_item.video_tags | default('') }}">
                    <div class="video-embed">
                        {% if video_item.filename and video_item.filename.startswith('http') %}
                            <iframe src="{{ video_item.filename }}" frameborder="0" allowfullscreen></iframe>
                        {% else %}
                            <video controls>
                                <source src="{{ url_for('static', filename='career_videos/' + video_item.filename) }}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        {% endif %}
                    </div>
                    <div class="video-info">
                        <h3 class="video-title">{{ video_item.title }}</h3>
                        <p class="video-description">
                            {{ video_item.description or 'No description available.' }}
                        </p>
                        {% if video_item.is_relevant %}
                            <span class="relevant-tag">RECOMMENDED FOR YOU</span>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
        
        {% if not videos %}
            <p class="no-videos-message">No videos were found for your search.</p>
        {% endif %}

        <a href="{{ url_for('select_video_skills') }}" class="back-link">‚Üê Change Filter Skills</a>
    </div>

    <script>
        // CLIENT-SIDE FILTERING LOGIC
        function liveFilterVideos() {
            const searchBar = document.getElementById('liveSearchBar');
            const query = searchBar.value.toLowerCase();
            const videoCards = document.querySelectorAll('.video-card');

            videoCards.forEach(card => {
                const title = card.querySelector('.video-title').textContent.toLowerCase();
                const description = card.querySelector('.video-description').textContent.toLowerCase();
                
                if (title.includes(query) || description.includes(query)) {
                    // Uses 'flex' from CSS to display the cards
                    card.style.display = 'flex'; 
                } else {
                    card.style.display = 'none';
                }
            });
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const searchBar = document.getElementById('liveSearchBar');
            searchBar.addEventListener('keyup', liveFilterVideos);
        });
    </script>

    <script src="{{ url_for('static', filename='search.js') }}"></script>
</body>
</html>