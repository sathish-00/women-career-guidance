<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Select Your Skills</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='career_interests.css') }}">
</head>
<body>
    <div class="container">
        <h2>Select Your Skills</h2>
        <form method="POST" action="{{ url_for('career_interests') }}">
            <div class="skills-list">
                {%- if available_skills is mapping %}
                    {# If available_skills is a dict: skill -> info dict #}
                    {% for skill, info in available_skills.items()|sort %}
                        <div class="skill-option">
                            <label>
                                <input type="checkbox" name="skills" value="{{ skill }}" {% if skill in current_skills %}checked{% endif %} />
                                {{ skill }}
                            </label>
                            {% if info.description %}
                                <p>{{ info.description }}</p>
                            {% endif %}
                            {% if info.reference %}
                                <a href="{{ info.reference }}" target="_blank">Learn More</a>
                            {% endif %}
                        </div>
                    {% endfor %}
                {%- elif available_skills is iterable %}
                    {# If available_skills is a simple list of skill names #}
                    {% for skill in available_skills %}
                        <div class="skill-option">
                            <label>
                                <input type="checkbox" name="skills" value="{{ skill }}" {% if skill in current_skills %}checked{% endif %} />
                                {{ skill }}
                            </label>
                        </div>
                    {% endfor %}
                {%- else %}
                    <p>No skills data available.</p>
                {%- endif %}
            </div>
            <button type="submit">Save Skills</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const skillOptions = document.querySelectorAll('.skill-option');
            
            skillOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const checkbox = option.querySelector('input[type="checkbox"]');
                    checkbox.checked = !checkbox.checked;
                    
                    // You can add or remove a class here to style the selected card
                    if (checkbox.checked) {
                        option.classList.add('selected');
                    } else {
                        option.classList.remove('selected');
                    }
                });
            });
        });
    </script>
</body>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const skillOptions = document.querySelectorAll('.skill-option');
        
        skillOptions.forEach(option => {
            option.addEventListener('click', (event) => {
                // Prevent the click event from doing anything else
                event.stopPropagation();
                
                const checkbox = option.querySelector('input[type="checkbox"]');
                checkbox.checked = !checkbox.checked;
                
                // Toggle the 'selected' class based on the checkbox state
                if (checkbox.checked) {
                    option.classList.add('selected');
                } else {
                    option.classList.remove('selected');
                }
            });
        });

        // Loop through initially checked boxes to apply the 'selected' class on page load
        const checkedBoxes = document.querySelectorAll('.skill-option input[type="checkbox"]:checked');
        checkedBoxes.forEach(checkbox => {
            checkbox.parentElement.parentElement.classList.add('selected');
        });
    });
</script>
</html>